<Window x:Class="BYWG.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:BYWG"
        mc:Ignorable="d"
        Title="工业边缘网关" Height="600" Width="900">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>
        <Grid.ColumnDefinitions>
            <ColumnDefinition Width="200"/>
            <ColumnDefinition Width="*"/>
        </Grid.ColumnDefinitions>
        
        <!-- 顶部状态栏 -->
        <StackPanel Grid.Row="0" Grid.ColumnSpan="2" Orientation="Horizontal" Background="#2c3e50">
            <TextBlock FontSize="16" FontWeight="Bold" Foreground="White" Text="工业边缘网关"/>
            <TextBlock x:Name="statusText" Margin="20,0,0,0" Foreground="White" Text="就绪"/>
            <Button x:Name="startServerBtn" Content="启动服务" HorizontalAlignment="Right" Margin="0,0,10,0" Width="100"/>
            <Button x:Name="stopServerBtn" Content="停止服务" HorizontalAlignment="Right" Width="100" IsEnabled="False"/>
        </StackPanel>
        
        <!-- 左侧菜单 -->
        <Border Grid.Row="1" Grid.Column="0" BorderThickness="0,0,1,0" BorderBrush="#e0e0e0">
            <StackPanel>
                <Button Content="协议配置" Margin="5"/>
                <Button Content="OPC UA设置" Margin="5"/>
                <Button Content="数据监控" Margin="5"/>
                <Button Content="系统日志" Margin="5"/>
            </StackPanel>
        </Border>
        
        <!-- 主内容区域 -->
        <TabControl Grid.Row="1" Grid.Column="1" x:Name="mainTabControl">
            <TabItem Header="仪表板">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Text="边缘网关状态信息" FontSize="18" Margin="10" Grid.Row="0"/>
                    
                    <ScrollViewer Grid.Row="1" Margin="10">
                        <Grid x:Name="dashboardGrid">
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>
                            
                            <!-- 系统状态卡片 -->
                            <Border Grid.Row="0" Grid.Column="0" Margin="5" Padding="10" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="1" CornerRadius="5">
                                <StackPanel>
                                    <TextBlock Text="系统状态" FontWeight="Bold" FontSize="14"/>
                                    <TextBlock x:Name="systemStatusText" Text="运行中" Margin="0,5,0,0"/>
                                    <TextBlock x:Name="uptimeText" Text="运行时间: 00:00:00" FontSize="12" Foreground="#6c757d"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- 连接状态卡片 -->
                            <Border Grid.Row="0" Grid.Column="1" Margin="5" Padding="10" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="1" CornerRadius="5">
                                <StackPanel>
                                    <TextBlock Text="连接状态" FontWeight="Bold" FontSize="14"/>
                                    <TextBlock x:Name="connectionCountText" Text="连接数: 0" Margin="0,5,0,0"/>
                                    <TextBlock x:Name="activeProtocolsText" Text="活跃协议: 0" FontSize="12" Foreground="#6c757d"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- 数据传输卡片 -->
                            <Border Grid.Row="1" Grid.Column="0" Margin="5" Padding="10" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="1" CornerRadius="5">
                                <StackPanel>
                                    <TextBlock Text="数据传输" FontWeight="Bold" FontSize="14"/>
                                    <TextBlock x:Name="dataRateText" Text="速率: 0 B/s" Margin="0,5,0,0"/>
                                    <TextBlock x:Name="totalDataText" Text="总量: 0 B" FontSize="12" Foreground="#6c757d"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- 错误统计卡片 -->
                            <Border Grid.Row="1" Grid.Column="1" Margin="5" Padding="10" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="1" CornerRadius="5">
                                <StackPanel>
                                    <TextBlock Text="错误统计" FontWeight="Bold" FontSize="14"/>
                                    <TextBlock x:Name="errorCountText" Text="错误数: 0" Margin="0,5,0,0"/>
                                    <TextBlock x:Name="lastErrorText" Text="最后错误: 无" FontSize="12" Foreground="#6c757d"/>
                                </StackPanel>
                            </Border>
                            
                            <!-- 实时数据监控 -->
                            <Border Grid.Row="2" Grid.ColumnSpan="2" Margin="5" Padding="10" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="1" CornerRadius="5">
                                <StackPanel>
                                    <TextBlock Text="实时数据监控" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
                                    <DataGrid x:Name="dataGrid" Height="200" AutoGenerateColumns="False" IsReadOnly="True">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="协议" Binding="{Binding Protocol}" Width="100"/>
                                            <DataGridTextColumn Header="数据点" Binding="{Binding Name}" Width="150"/>
                                            <DataGridTextColumn Header="值" Binding="{Binding Value}" Width="100"/>
                                            <DataGridTextColumn Header="类型" Binding="{Binding DataType}" Width="80"/>
                                            <DataGridTextColumn Header="时间戳" Binding="{Binding Timestamp}" Width="150"/>
                                            <DataGridTextColumn Header="质量" Binding="{Binding Quality}" Width="80"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                            </Border>
                        </Grid>
                    </ScrollViewer>
                </Grid>
            </TabItem>
            
            <TabItem Header="协议管理">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="10">
                        <TextBlock Text="协议配置管理" FontSize="18" VerticalAlignment="Center"/>
                        <Button x:Name="addProtocolBtn" Content="添加协议" Margin="20,0,0,0" Padding="10,5" Click="AddProtocolBtn_Click"/>
                        <Button x:Name="refreshProtocolsBtn" Content="刷新" Margin="10,0,0,0" Padding="10,5" Click="RefreshProtocolsBtn_Click"/>
                    </StackPanel>
                    
                    <Grid Grid.Row="1" Margin="10">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="300"/>
                            <ColumnDefinition Width="*"/>
                        </Grid.ColumnDefinitions>
                        
                        <!-- 协议列表 -->
                        <Border Grid.Column="0" Margin="0,0,10,0" Padding="10" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="1" CornerRadius="5">
                            <StackPanel>
                                <TextBlock Text="协议列表" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
                                <ListBox x:Name="protocolListBox" Height="400" SelectionChanged="ProtocolListBox_SelectionChanged">
                                    <ListBox.ItemTemplate>
                                        <DataTemplate>
                                            <StackPanel>
                                                <TextBlock Text="{Binding Name}" FontWeight="Bold"/>
                                                <TextBlock Text="{Binding Type}" FontSize="12" Foreground="#6c757d"/>
                                                <TextBlock Text="{Binding Status}" FontSize="12" Foreground="#28a745"/>
                                            </StackPanel>
                                        </DataTemplate>
                                    </ListBox.ItemTemplate>
                                </ListBox>
                            </StackPanel>
                        </Border>
                        
                        <!-- 协议配置详情 -->
                        <Border Grid.Column="1" Padding="10" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="1" CornerRadius="5">
                            <ScrollViewer>
                                <StackPanel x:Name="protocolConfigPanel">
                                    <TextBlock Text="协议配置" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
                                    <TextBlock x:Name="noSelectionText" Text="请选择一个协议进行配置" Foreground="#6c757d"/>
                                </StackPanel>
                            </ScrollViewer>
                        </Border>
                    </Grid>
                </Grid>
            </TabItem>
            
            <TabItem Header="OPC UA服务器">
                <Grid>
                    <Grid.RowDefinitions>
                        <RowDefinition Height="Auto"/>
                        <RowDefinition Height="*"/>
                    </Grid.RowDefinitions>
                    
                    <TextBlock Text="OPC UA服务器配置" FontSize="18" Margin="10" Grid.Row="0"/>
                    
                    <ScrollViewer Grid.Row="1" Margin="10">
                        <StackPanel>
                            <!-- 服务器配置 -->
                            <Border Margin="0,0,0,10" Padding="15" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="1" CornerRadius="5">
                                <StackPanel>
                                    <TextBlock Text="服务器配置" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
                                    
                                    <Grid>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="*"/>
                                        </Grid.ColumnDefinitions>
                                        
                                        <TextBlock Text="端点URL:" Grid.Row="0" Grid.Column="0" VerticalAlignment="Center" Margin="0,5"/>
                                        <TextBox x:Name="endpointUrlTextBox" Grid.Row="0" Grid.Column="1" Text="opc.tcp://localhost:4840/" Margin="10,5,0,5"/>
                                        
                                        <TextBlock Text="应用名称:" Grid.Row="1" Grid.Column="0" VerticalAlignment="Center" Margin="0,5"/>
                                        <TextBox x:Name="applicationNameTextBox" Grid.Row="1" Grid.Column="1" Text="BYWG.IndustrialGateway" Margin="10,5,0,5"/>
                                        
                                        <TextBlock Text="最大连接数:" Grid.Row="2" Grid.Column="0" VerticalAlignment="Center" Margin="0,5"/>
                                        <TextBox x:Name="maxConnectionsTextBox" Grid.Row="2" Grid.Column="1" Text="10" Margin="10,5,0,5"/>
                                        
                                        <TextBlock Text="安全策略:" Grid.Row="3" Grid.Column="0" VerticalAlignment="Center" Margin="0,5"/>
                                        <ComboBox x:Name="securityPolicyComboBox" Grid.Row="3" Grid.Column="1" Margin="10,5,0,5">
                                            <ComboBoxItem Content="None" IsSelected="True"/>
                                            <ComboBoxItem Content="Basic128Rsa15"/>
                                            <ComboBoxItem Content="Basic256"/>
                                            <ComboBoxItem Content="Basic256Sha256"/>
                                        </ComboBox>
                                    </Grid>
                                </StackPanel>
                            </Border>
                            
                            <!-- 节点管理 -->
                            <Border Padding="15" Background="#f8f9fa" BorderBrush="#dee2e6" BorderThickness="1" CornerRadius="5">
                                <StackPanel>
                                    <TextBlock Text="节点管理" FontWeight="Bold" FontSize="14" Margin="0,0,0,10"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                        <TextBlock Text="设备:" VerticalAlignment="Center"/>
                                        <ComboBox x:Name="deviceFilterComboBox" Width="220" Margin="10,0,0,0"/>
                                        <Button x:Name="refreshDevicesBtn" Content="刷新设备" Padding="10,5" Margin="10,0,0,0" Click="RefreshDevicesBtn_Click"/>
                                    </StackPanel>
                                    
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                                        <Button x:Name="addNodeBtn" Content="添加节点" Padding="10,5" Click="AddNodeBtn_Click"/>
                                        <Button x:Name="removeNodeBtn" Content="删除节点" Padding="10,5" Margin="10,0,0,0" Click="RemoveNodeBtn_Click"/>
                                        <Button x:Name="refreshNodesBtn" Content="刷新节点" Padding="10,5" Margin="10,0,0,0" Click="RefreshNodesBtn_Click"/>
                                    </StackPanel>
                                    
                                    <DataGrid x:Name="nodesDataGrid" Height="200" AutoGenerateColumns="False" IsReadOnly="True">
                                        <DataGrid.Columns>
                                            <DataGridTextColumn Header="节点ID" Binding="{Binding NodeId}" Width="150"/>
                                            <DataGridTextColumn Header="显示名称" Binding="{Binding DisplayName}" Width="150"/>
                                            <DataGridTextColumn Header="数据类型" Binding="{Binding DataType}" Width="100"/>
                                            <DataGridTextColumn Header="当前值" Binding="{Binding Value}" Width="100"/>
                                            <DataGridTextColumn Header="时间戳" Binding="{Binding Timestamp}" Width="150"/>
                                        </DataGrid.Columns>
                                    </DataGrid>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </ScrollViewer>
                </Grid>
            </TabItem>
        </TabControl>
        
        <!-- 底部状态栏 -->
        <StatusBar Grid.Row="2" Grid.ColumnSpan="2">
            <StatusBarItem>
                <TextBlock x:Name="connectionStatus" Text="OPC UA服务：未运行"/>
            </StatusBarItem>
        </StatusBar>
    </Grid>
</Window>
